<?xml version="1.0" encoding="utf-8" ?>
<!--============================================================================
//	CAUTION: This file is generated by BatisMap.cst at 2011-01-29 15:49:28
//				Any manual editing will be lost in re-generation.
//===========================================================================-->
<sqlMap namespace="Sys_MenuInRole"
	xmlns="http://ibatis.apache.org/mapping"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

    <alias>
        <typeAlias alias="Sys_MenuInRole" type="KingSite.Purview.Domain.Sys_MenuInRole, KingSite.Purview" />
    </alias>

    <resultMaps>
        <resultMap id="FullResultMap" class="Sys_MenuInRole">
            <result property="Id" column="Id"/>
            <result property="MenuId" column="MenuId"/>
            <result property="RoleId" column="RoleId"/>
            <result property="ParentMenuId" column="ParentMenuId"/>
        </resultMap>
    </resultMaps>

    <statements>

        <select id="GetCount" resultClass="System.Int32">
            SELECT count(*) FROM Sys_MenuInRole
        </select>

        <select id="FindAll" resultMap="FullResultMap">
            SELECT *
            FROM Sys_MenuInRole
        </select>

        <select id="Find" parameterClass="Sys_MenuInRole" resultMap="FullResultMap" extends="FindAll">
            WHERE
            (Id = #Id#)
        </select>

        <select id="FindByMenuId" parameterClass="Int32" resultMap="FullResultMap" extends="FindAll">
            WHERE (MenuId = #value#)
        </select>
        <select id="FindByRoleId" parameterClass="Int32" resultMap="FullResultMap" extends="FindAll">
            WHERE (RoleId = #value#)
        </select>
        <select id="FindByParentMenuId" parameterClass="Int32" resultMap="FullResultMap" extends="FindAll">
            WHERE (ParentMenuId = #value#)
        </select>

        <select id="FindByRoleName" parameterClass="String" resultMap="FullResultMap">
            Select Distinct mir.* from Sys_MenuInRole mir
            join Sys_Role r on r.Id = mir.roleid
            where r.rolename in ($value$)
        </select>

        <statement id="FindToNavTreeMenu" parameterClass="map" resultMap="FullResultMap" >
            Select Distinct m.Id,m.MenuName,mir.ParentMenuId,m.IconName,m.PathLocation from Sys_MenuInRole mir
            join Sys_Role r on r.Id = mir.roleid
            join Sys_Menu m on m.Id = mir.MenuId
            where r.rolename in ($RoleName$) and ParentMenuId = $ParentMenuId$
        </statement>

        <insert id="Insert" parameterClass="Sys_MenuInRole">
            INSERT INTO Sys_MenuInRole (
            Id
            , MenuId
            , RoleId
            , ParentMenuId
            ) VALUES (
            SEQ_KSP.NEXTVAL
            , #MenuId#
            , #RoleId#
            , #ParentMenuId#
            )
        </insert>

        <update id="Update" parameterClass="Sys_MenuInRole">
            UPDATE Sys_MenuInRole SET
            MenuId = #MenuId#
            , RoleId = #RoleId#
            , ParentMenuId = #ParentMenuId#
            WHERE
            (Id = #Id#)
        </update>

        <delete id="Delete" parameterClass="Sys_MenuInRole">
            DELETE FROM Sys_MenuInRole
            WHERE
            (Id = #Id#)
        </delete>

        <delete id="DeleteByMenuId" parameterClass="Int32">
            DELETE FROM Sys_MenuInRole WHERE (MenuId = #value#)
        </delete>
        <delete id="DeleteByRoleId" parameterClass="Int32">
            DELETE FROM Sys_MenuInRole WHERE (RoleId = #value#)
        </delete>
        <delete id="DeleteByParentMenuId" parameterClass="Int32">
            DELETE FROM Sys_MenuInRole WHERE (ParentMenuId = #value#)
        </delete>

        <select id="Reload" parameterClass="Sys_MenuInRole" resultMap="FullResultMap" extends="FindAll">
            WHERE (Id = #Id#)
        </select>
    </statements>
</sqlMap>
