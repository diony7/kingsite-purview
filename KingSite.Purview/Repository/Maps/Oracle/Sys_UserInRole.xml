<?xml version="1.0" encoding="utf-8" ?>
<!--============================================================================
//	CAUTION: This file is generated by BatisMap.cst at 2009-08-03 9:32:51
//				Any manual editing will be lost in re-generation.
//===========================================================================-->
<sqlMap namespace="Sys_UserInRole"
	xmlns="http://ibatis.apache.org/mapping"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

    <alias>
        <typeAlias alias="Sys_UserInRole" type="KingSite.Purview.Domain.Sys_UserInRole, KingSite.Purview" />
    </alias>

    <resultMaps>
        <resultMap id="FullResultMap" class="Sys_UserInRole">
            <result property="Id" column="Id"/>
            <result property="ApplicationName" column="ApplicationName"/>
            <result property="UserName" column="UserName"/>
            <result property="RoleName" column="RoleName"/>
            
        </resultMap>
    </resultMaps>

    <statements>

        <select id="GetCount" resultClass="int">
            SELECT count(*) FROM Sys_UserInRole
        </select>

        <select id="FindAll" resultMap="FullResultMap">
            SELECT *
            FROM Sys_UserInRole
        </select>

        <select id="GetRolesForUser" parameterClass="Sys_UserInRole" resultMap="FullResultMap" extends="FindAll">
            WHERE
            ApplicationName = #ApplicationName# and UserName = #UserName#
        </select>

        <select id="GetUsersInRole" parameterClass="Sys_UserInRole" resultMap="FullResultMap" extends="FindAll">
            WHERE
            ApplicationName = #ApplicationName# and RoleName = #RoleName#
        </select>

        <select id="IsUserInRole" parameterClass="Sys_UserInRole" resultClass="int">
            SELECT count(*) FROM Sys_UserInRole 
            WHERE
            ApplicationName = #ApplicationName# and RoleName = #RoleName# and UserName = #UserName#
        </select>

        <select id="FindUsersInRole" parameterClass="Sys_UserInRole" resultMap="FullResultMap" extends="FindAll">
            WHERE
            UserName LIKE '%'||#UserName#||'%' AND RoleName = #RoleName# AND ApplicationName = #ApplicationName#
        </select>
        

        <update id="Insert" parameterClass="Sys_UserInRole">
            INSERT INTO Sys_UserInRole (
            Id
            , ApplicationName
            , UserName
            , RoleName
            ) VALUES (
            SEQ_KSP.NEXTVAL
            , #ApplicationName#
            , #UserName#
            , #RoleName#
            )
        </update>

        <update id="DeleteByName" parameterClass="Sys_UserInRole">
            DELETE FROM Sys_UserInRole
            WHERE Username = #UserName# AND RoleName = #RoleName# AND ApplicationName = #ApplicationName#
        </update>

    </statements>
</sqlMap>
